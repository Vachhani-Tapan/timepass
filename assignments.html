<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnSmart AI | Practice Assignments</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --danger: #ef4444;
            --light: #f8f9fa;
            --dark: #1e293b;
            --gray: #64748b;
            --light-gray: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .logo i {
            color: var(--accent);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover,
        nav a.active {
            color: var(--primary);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* Main Content */
        .main-content {
            min-height: calc(100vh - 150px);
            padding: 40px 0;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-header h1 {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .page-header p {
            color: var(--gray);
            font-size: 1.1rem;
        }

        /* Subject Grid */
        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .subject-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .subject-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: white;
            font-size: 2rem;
        }

        .subject-card h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }

        .subject-card p {
            color: var(--gray);
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .subject-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--gray);
        }

        /* Test Section */
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 40px;
        }

        .test-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .test-header h2 {
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .test-header p {
            color: var(--gray);
        }

        .test-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .info-card h4 {
            color: var(--dark);
            margin-bottom: 10px;
        }

        .info-card p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Buttons */
        .btn {
            padding: 12px 30px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(67, 97, 238, 0.1);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #10b981);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 222, 128, 0.3);
        }

        .btn-block {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-large {
            padding: 15px 40px;
            font-size: 1.1rem;
        }

        .test-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 30px;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #666;
            cursor: pointer;
        }

        .modal-body {
            padding: 20px;
        }

        /* Test Interface */
        .test-interface {
            background: white;
            border-radius: 12px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .test-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
        }

        .test-header h2 {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .test-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .test-timer {
            font-weight: bold;
            font-size: 1.2rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
        }

        .test-body {
            padding: 30px;
        }

        .question-section {
            background: #f8fafc;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .question-number {
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option:hover {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.05);
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.1);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .option.incorrect {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .option-letter {
            width: 30px;
            height: 30px;
            background: #e2e8f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--dark);
        }

        .option.selected .option-letter {
            background: var(--primary);
            color: white;
        }

        .test-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .nav-btn {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .question-dots {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
        }

        .question-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #ddd;
            background: white;
            font-weight: bold;
        }

        .question-dot.answered {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .question-dot.current {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .question-dot.unanswered {
            background: white;
            color: #666;
        }

        /* Results Modal */
        .results-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .results-header {
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 15px 15px 0 0;
        }

        .results-body {
            padding: 30px;
        }

        .score-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) 0% 75%, #e2e8f0 75% 100%);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
        }

        .score-circle span {
            position: relative;
            z-index: 1;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .result-stat {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .results-footer {
            padding: 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background-color: var(--light-gray);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress {
            height: 100%;
            background-color: var(--primary);
            border-radius: 4px;
            transition: width 0.3s;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .subjects-grid {
                grid-template-columns: 1fr;
            }

            .test-info {
                grid-template-columns: 1fr;
            }

            .test-actions {
                flex-direction: column;
            }

            .btn-large {
                padding: 12px 20px;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="nav-container">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <span>LearnSmart AI</span>
                </div>

                <nav>
                    <ul>
                        <li><a href="mainexperiment.html">Dashboard</a></li>
                        <li><a href="#" class="active">Assignments</a></li>
                        <li><a href="mainexperiment.html">Learning Path</a></li>
                        <li><a href="mainexperiment.html">Assessments</a></li>
                    </ul>
                </nav>

                <div class="user-profile">
                    <div class="avatar">JS</div>
                    <div>
                        <div class="user-name">Jamie Smith</div>
                        <div class="user-level">Advanced Learner</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <main class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <h1><i class="fas fa-tasks"></i> Practice Assignments</h1>
                <p>Practice with 50 questions per subject or take the weekly test</p>
            </div>

            <!-- Subjects Grid -->
            <div class="subjects-grid" id="subjectsGrid">
                <!-- Subjects will be loaded dynamically -->
            </div>

            <!-- Weekly Test Section -->
            <div class="test-section">
                <div class="test-header">
                    <h2><i class="fas fa-calendar-alt"></i> Weekly Test</h2>
                    <p>Test your knowledge with random questions from all subjects</p>
                </div>

                <div class="test-info">
                    <div class="info-card">
                        <h4><i class="fas fa-question-circle"></i> Questions</h4>
                        <p>50 random questions from all subjects</p>
                    </div>
                    <div class="info-card">
                        <h4><i class="fas fa-clock"></i> Duration</h4>
                        <p>90 minutes (1.5 hours)</p>
                    </div>
                    <div class="info-card">
                        <h4><i class="fas fa-chart-line"></i> Difficulty</h4>
                        <p>Adaptive based on your practice</p>
                    </div>
                    <div class="info-card">
                        <h4><i class="fas fa-trophy"></i> Rewards</h4>
                        <p>Earn badges and certificates</p>
                    </div>
                </div>

                <div class="test-progress">
                    <h4>Weekly Progress</h4>
                    <div class="progress-bar">
                        <div class="progress" style="width: 60%"></div>
                    </div>
                    <p>You've completed 3 out of 5 practice sessions this week</p>
                </div>

                <div class="test-actions">
                    <button class="btn btn-primary btn-large" id="startWeeklyTestBtn">
                        <i class="fas fa-play-circle"></i> Start Weekly Test
                    </button>
                    <button class="btn btn-secondary btn-large" id="viewScoresBtn">
                        <i class="fas fa-chart-bar"></i> View Previous Scores
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Practice Modal -->
    <div class="modal-overlay" id="practiceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-book"></i> Practice Mode - <span id="practiceSubject">Subject</span></h3>
                <button class="modal-close" id="closePracticeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="practice-info">
                    <h4>Practice Configuration</h4>
                    <p>You'll practice with 50 questions from <span id="subjectName">JavaScript</span>.</p>
                    
                    <div class="config-section">
                        <h5>Select Difficulty</h5>
                        <div class="difficulty-options">
                            <button class="difficulty-btn active" data-difficulty="mixed">Mixed Difficulty</button>
                            <button class="difficulty-btn" data-difficulty="easy">Easy</button>
                            <button class="difficulty-btn" data-difficulty="medium">Medium</button>
                            <button class="difficulty-btn" data-difficulty="hard">Hard</button>
                        </div>
                    </div>
                    
                    <div class="practice-stats">
                        <h5>Your Previous Performance</h5>
                        <div class="stats-grid">
                            <div class="stat">
                                <span class="stat-value">78%</span>
                                <span class="stat-label">Accuracy</span>
                            </div>
                            <div class="stat">
                                <span class="stat-value">45</span>
                                <span class="stat-label">Questions Attempted</span>
                            </div>
                            <div class="stat">
                                <span class="stat-value">28m</span>
                                <span class="stat-label">Average Time</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding: 20px; border-top: 1px solid #eee; text-align: right;">
                <button class="btn btn-secondary" id="cancelPracticeBtn">Cancel</button>
                <button class="btn btn-primary" id="startPracticeBtn">Start Practice Session</button>
            </div>
        </div>
    </div>

    <!-- Practice Interface -->
    <div class="modal-overlay" id="practiceInterface">
        <div class="test-interface">
            <div class="test-header">
                <h2><i class="fas fa-book-open"></i> Practice - <span id="currentSubject">JavaScript</span></h2>
                <div class="test-meta">
                    <div>Question: <span id="currentQuestionNum">1</span>/<span id="totalQuestionsNum">50</span></div>
                    <div class="test-timer" id="practiceTimer">No Limit</div>
                    <div>Score: <span id="practiceScore">0</span></div>
                </div>
            </div>

            <div class="test-body">
                <div class="question-section">
                    <div class="question-number">
                        <i class="fas fa-question-circle"></i> Question <span id="qNum">1</span>
                    </div>
                    <div class="question-text" id="questionDisplay">
                        Loading question...
                    </div>

                    <div class="options-container" id="optionsDisplay">
                        <!-- Options will be dynamically inserted here -->
                    </div>

                    <div class="question-dots" id="questionDots">
                        <!-- Question navigation dots will be inserted here -->
                    </div>
                </div>

                <div class="test-controls">
                    <div class="test-actions">
                        <button class="btn btn-secondary" id="showExplanationBtn">
                            <i class="fas fa-lightbulb"></i> Show Explanation
                        </button>
                        <button class="btn btn-danger" id="endPracticeBtn">
                            <i class="fas fa-stop"></i> End Practice
                        </button>
                    </div>

                    <div class="question-nav">
                        <button class="nav-btn" id="prevBtn" disabled>
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="nav-btn" id="nextBtn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal-overlay" id="resultsModal">
        <div class="results-content">
            <div class="results-header">
                <h2><i class="fas fa-trophy"></i> Practice Completed!</h2>
                <p>Here's your performance analysis</p>
            </div>
            <div class="results-body">
                <div class="score-display">
                    <div class="score-circle">
                        <span id="finalScore">75</span>%
                    </div>
                    <h3>Your Score: <span id="scoreText">38</span>/<span id="totalText">50</span></h3>
                </div>

                <div class="results-grid">
                    <div class="result-stat">
                        <h4>Time Taken</h4>
                        <p id="timeTakenText">45:20</p>
                    </div>
                    <div class="result-stat">
                        <h4>Accuracy</h4>
                        <p id="accuracyText">76%</p>
                    </div>
                    <div class="result-stat">
                        <h4>Strongest Area</h4>
                        <p id="strongArea">Functions</p>
                    </div>
                    <div class="result-stat">
                        <h4>Needs Practice</h4>
                        <p id="weakArea">Async Programming</p>
                    </div>
                </div>
                
                <div class="recommendations">
                    <h4><i class="fas fa-graduation-cap"></i> Recommendations</h4>
                    <p id="recommendationsText">Focus on asynchronous programming concepts and review promises and async/await patterns.</p>
                </div>
            </div>
            <div class="results-footer">
                <button class="btn btn-secondary" id="closeResultsBtn">Back to Assignments</button>
                <button class="btn btn-primary" id="reviewWrongBtn">Review Wrong Answers</button>
                <button class="btn btn-success" id="practiceMoreBtn">Practice More</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>LearnSmart AI &copy; 2023 - EdTech 2.0 Platform for Smarter Learning</p>
            <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
                Personalized Learning | Adaptive Assessment | Productivity Tools
            </p>
        </div>
    </footer>

    <script>
        // Subjects Data
        const subjects = [
            {
                id: 'javascript',
                name: 'JavaScript',
                icon: 'fab fa-js',
                description: 'Modern JavaScript ES6+, DOM Manipulation, Async Programming',
                color: '#F0DB4F',
                questions: 50,
                completed: 25,
                accuracy: 78
            },
            {
                id: 'python',
                name: 'Python',
                icon: 'fab fa-python',
                description: 'Python 3, Data Structures, OOP, Libraries',
                color: '#3776AB',
                questions: 50,
                completed: 30,
                accuracy: 82
            },
            {
                id: 'html',
                name: 'HTML5',
                icon: 'fab fa-html5',
                description: 'Semantic HTML, Forms, Accessibility, APIs',
                color: '#E34F26',
                questions: 50,
                completed: 40,
                accuracy: 85
            },
            {
                id: 'css',
                name: 'CSS3',
                icon: 'fab fa-css3',
                description: 'Flexbox, Grid, Animations, Responsive Design',
                color: '#264DE4',
                questions: 50,
                completed: 35,
                accuracy: 72
            },
            {
                id: 'react',
                name: 'React',
                icon: 'fab fa-react',
                description: 'Components, Hooks, State Management, Router',
                color: '#61DAFB',
                questions: 50,
                completed: 20,
                accuracy: 68
            },
            {
                id: 'c',
                name: 'C Programming',
                icon: 'fas fa-c',
                description: 'Pointers, Memory Management, Data Structures',
                color: '#A8B9CC',
                questions: 50,
                completed: 15,
                accuracy: 65
            },
            {
                id: 'algorithms',
                name: 'Algorithms',
                icon: 'fas fa-sort-amount-down',
                description: 'Sorting, Searching, Graph Algorithms, Complexity',
                color: '#00B4D8',
                questions: 50,
                completed: 28,
                accuracy: 70
            },
            {
                id: 'datastructures',
                name: 'Data Structures',
                icon: 'fas fa-project-diagram',
                description: 'Arrays, Linked Lists, Trees, Hash Tables',
                color: '#FF6B6B',
                questions: 50,
                completed: 22,
                accuracy: 75
            }
        ];

        // Questions Database (Simplified for demo)
        const questionsDatabase = {
            javascript: generateJavaScriptQuestions(),
            python: generatePythonQuestions(),
            html: generateHTMLQuestions(),
            css: generateCSSQuestions(),
            react: generateReactQuestions(),
            c: generateCQuestions(),
            algorithms: generateAlgorithmQuestions(),
            datastructures: generateDataStructureQuestions()
        };

        // Practice State
        let practiceState = {
            subject: null,
            questions: [],
            currentQuestion: 0,
            answers: [],
            score: 0,
            startTime: null,
            isReviewing: false,
            difficulty: 'mixed'
        };

        // Weekly Test State
        let weeklyTestState = {
            questions: [],
            currentQuestion: 0,
            answers: [],
            score: 0,
            startTime: null,
            timeRemaining: 90 * 60, // 90 minutes in seconds
            timerInterval: null
        };

        // DOM Elements
        const subjectsGrid = document.getElementById('subjectsGrid');
        const practiceModal = document.getElementById('practiceModal');
        const practiceInterface = document.getElementById('practiceInterface');
        const resultsModal = document.getElementById('resultsModal');
        const startWeeklyTestBtn = document.getElementById('startWeeklyTestBtn');

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            renderSubjects();
            setupEventListeners();
            loadUserProgress();
        });

        // Render subjects grid
        function renderSubjects() {
            subjectsGrid.innerHTML = '';
            
            subjects.forEach(subject => {
                const progress = (subject.completed / subject.questions) * 100;
                
                const subjectCard = document.createElement('div');
                subjectCard.className = 'subject-card';
                subjectCard.dataset.subject = subject.id;
                
                subjectCard.innerHTML = `
                    <div class="subject-icon" style="background: ${subject.color}">
                        <i class="${subject.icon}"></i>
                    </div>
                    <h3>${subject.name}</h3>
                    <p>${subject.description}</p>
                    
                    <div class="progress-bar">
                        <div class="progress" style="width: ${progress}%"></div>
                    </div>
                    <p style="font-size: 0.9rem; margin-top: 5px;">${subject.completed}/${subject.questions} questions completed</p>
                    
                    <div class="subject-stats">
                        <div class="stat-item">
                            <div class="stat-value">${subject.accuracy}%</div>
                            <div class="stat-label">Accuracy</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${subject.questions}</div>
                            <div class="stat-label">Total</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${subject.completed}</div>
                            <div class="stat-label">Done</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary btn-block" style="margin-top: 20px;" data-subject="${subject.id}">
                        <i class="fas fa-play"></i> Start Practice
                    </button>
                `;
                
                subjectsGrid.appendChild(subjectCard);
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Subject card click handlers
            document.addEventListener('click', function(e) {
                if (e.target.closest('[data-subject]')) {
                    const subjectId = e.target.closest('[data-subject]').dataset.subject;
                    const subject = subjects.find(s => s.id === subjectId);
                    openPracticeModal(subject);
                }
            });

            // Practice modal
            document.getElementById('closePracticeModal').addEventListener('click', closePracticeModal);
            document.getElementById('cancelPracticeBtn').addEventListener('click', closePracticeModal);
            document.getElementById('startPracticeBtn').addEventListener('click', startPractice);

            // Difficulty buttons
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    practiceState.difficulty = this.dataset.difficulty;
                });
            });

            // Practice interface
            document.getElementById('endPracticeBtn').addEventListener('click', endPractice);
            document.getElementById('showExplanationBtn').addEventListener('click', showExplanation);

            // Results modal
            document.getElementById('closeResultsBtn').addEventListener('click', closeResultsModal);
            document.getElementById('reviewWrongBtn').addEventListener('click', reviewWrongAnswers);
            document.getElementById('practiceMoreBtn').addEventListener('click', practiceMore);

            // Weekly test button
            startWeeklyTestBtn.addEventListener('click', startWeeklyTest);

            // Close modals when clicking outside
            [practiceModal, practiceInterface, resultsModal].forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        if (modal === practiceInterface) {
                            if (confirm('Are you sure you want to end the practice session?')) {
                                endPractice();
                            }
                        } else {
                            closeModal(modal);
                        }
                    }
                });
            });
        }

        // Open practice modal
        function openPracticeModal(subject) {
            practiceState.subject = subject;
            
            document.getElementById('practiceSubject').textContent = subject.name;
            document.getElementById('subjectName').textContent = subject.name;
            
            // Update stats
            const statsGrid = document.querySelector('.stats-grid');
            statsGrid.innerHTML = `
                <div class="stat">
                    <span class="stat-value">${subject.accuracy}%</span>
                    <span class="stat-label">Accuracy</span>
                </div>
                <div class="stat">
                    <span class="stat-value">${subject.completed}</span>
                    <span class="stat-label">Questions Attempted</span>
                </div>
                <div class="stat">
                    <span class="stat-value">${Math.floor(Math.random() * 20) + 15}m</span>
                    <span class="stat-label">Average Time</span>
                </div>
            `;
            
            practiceModal.style.display = 'flex';
        }

        function closePracticeModal() {
            practiceModal.style.display = 'none';
        }

        // Start practice session
        function startPractice() {
            closePracticeModal();
            
            // Load questions for the selected subject
            practiceState.questions = getQuestionsForSubject(practiceState.subject.id, practiceState.difficulty);
            practiceState.currentQuestion = 0;
            practiceState.answers = new Array(practiceState.questions.length).fill(null);
            practiceState.score = 0;
            practiceState.startTime = new Date();
            practiceState.isReviewing = false;
            
            // Update UI
            document.getElementById('currentSubject').textContent = practiceState.subject.name;
            document.getElementById('totalQuestionsNum').textContent = practiceState.questions.length;
            
            // Show practice interface
            practiceInterface.style.display = 'flex';
            
            // Load first question
            updatePracticeQuestion();
            setupQuestionDots();
        }

        // Get questions for subject and difficulty
        function getQuestionsForSubject(subjectId, difficulty) {
            const allQuestions = questionsDatabase[subjectId] || [];
            
            // Filter by difficulty if not mixed
            let filteredQuestions = allQuestions;
            if (difficulty !== 'mixed') {
                filteredQuestions = allQuestions.filter(q => q.difficulty === difficulty);
            }
            
            // If we don't have enough questions, use all available
            const questionsToTake = Math.min(50, filteredQuestions.length);
            
            // Shuffle and take required number
            return [...filteredQuestions]
                .sort(() => Math.random() - 0.5)
                .slice(0, questionsToTake);
        }

        // Update practice question display
        function updatePracticeQuestion() {
            const question = practiceState.questions[practiceState.currentQuestion];
            const questionNum = practiceState.currentQuestion + 1;
            
            // Update question numbers
            document.getElementById('currentQuestionNum').textContent = questionNum;
            document.getElementById('qNum').textContent = questionNum;
            
            // Update question text
            document.getElementById('questionDisplay').textContent = question.question;
            
            // Update options
            const optionsContainer = document.getElementById('optionsDisplay');
            optionsContainer.innerHTML = '';
            
            const letters = ['A', 'B', 'C', 'D'];
            const userAnswer = practiceState.answers[practiceState.currentQuestion];
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.dataset.index = index;
                
                if (userAnswer === index) {
                    optionDiv.classList.add('selected');
                    
                    // If reviewing, show correct/incorrect
                    if (practiceState.isReviewing) {
                        if (index === question.correct) {
                            optionDiv.classList.add('correct');
                        } else {
                            optionDiv.classList.add('incorrect');
                        }
                    }
                }
                
                // If reviewing and this is correct answer, mark it
                if (practiceState.isReviewing && index === question.correct) {
                    optionDiv.classList.add('correct');
                }
                
                optionDiv.innerHTML = `
                    <div class="option-letter">${letters[index]}</div>
                    <div class="option-text">${option}</div>
                `;
                
                // Only allow selection if not reviewing
                if (!practiceState.isReviewing) {
                    optionDiv.addEventListener('click', () => selectPracticeOption(index));
                }
                
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = practiceState.currentQuestion === 0;
            
            if (practiceState.currentQuestion === practiceState.questions.length - 1) {
                document.getElementById('nextBtn').textContent = 'Finish Practice';
            } else {
                document.getElementById('nextBtn').textContent = 'Next';
            }
            
            // Update question dots
            updateQuestionDots();
            
            // Setup navigation buttons
            setupPracticeNavigation();
        }

        function selectPracticeOption(optionIndex) {
            const currentIndex = practiceState.currentQuestion;
            practiceState.answers[currentIndex] = optionIndex;
            
            // Update UI to show selection
            const options = document.querySelectorAll('.option');
            options.forEach((option, index) => {
                option.classList.remove('selected');
                if (index === optionIndex) {
                    option.classList.add('selected');
                }
            });
            
            // Update question dot
            updateQuestionDots();
            
            // Auto-advance after 1 second
            setTimeout(() => {
                if (practiceState.currentQuestion < practiceState.questions.length - 1) {
                    practiceState.currentQuestion++;
                    updatePracticeQuestion();
                }
            }, 1000);
        }

        function setupQuestionDots() {
            const dotsContainer = document.getElementById('questionDots');
            dotsContainer.innerHTML = '';
            
            for (let i = 0; i < practiceState.questions.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'question-dot';
                dot.textContent = i + 1;
                dot.dataset.index = i;
                
                if (i === practiceState.currentQuestion) {
                    dot.classList.add('current');
                } else if (practiceState.answers[i] !== null) {
                    dot.classList.add('answered');
                } else {
                    dot.classList.add('unanswered');
                }
                
                dot.addEventListener('click', () => {
                    if (!practiceState.isReviewing) {
                        practiceState.currentQuestion = i;
                        updatePracticeQuestion();
                    }
                });
                
                dotsContainer.appendChild(dot);
            }
        }

        function updateQuestionDots() {
            const dots = document.querySelectorAll('.question-dot');
            dots.forEach((dot, index) => {
                dot.classList.remove('current', 'answered', 'unanswered');
                
                if (index === practiceState.currentQuestion) {
                    dot.classList.add('current');
                } else if (practiceState.answers[index] !== null) {
                    dot.classList.add('answered');
                } else {
                    dot.classList.add('unanswered');
                }
            });
        }

        function setupPracticeNavigation() {
            // Remove existing event listeners
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            const newPrevBtn = prevBtn.cloneNode(true);
            const newNextBtn = nextBtn.cloneNode(true);
            
            prevBtn.parentNode.replaceChild(newPrevBtn, prevBtn);
            nextBtn.parentNode.replaceChild(newNextBtn, nextBtn);
            
            // Add new event listeners
            newPrevBtn.addEventListener('click', () => {
                if (practiceState.currentQuestion > 0) {
                    practiceState.currentQuestion--;
                    updatePracticeQuestion();
                }
            });
            
            newNextBtn.addEventListener('click', () => {
                if (practiceState.currentQuestion < practiceState.questions.length - 1) {
                    practiceState.currentQuestion++;
                    updatePracticeQuestion();
                } else {
                    finishPractice();
                }
            });
        }

        function showExplanation() {
            const question = practiceState.questions[practiceState.currentQuestion];
            const userAnswer = practiceState.answers[practiceState.currentQuestion];
            
            if (userAnswer === null) {
                alert('Please answer the question first!');
                return;
            }
            
            const explanation = `
                Question: ${question.question}
                
                Your Answer: ${question.options[userAnswer]}
                Correct Answer: ${question.options[question.correct]}
                
                Explanation: ${question.explanation}
                
                ${question.tips ? 'Tips: ' + question.tips.join(', ') : ''}
            `;
            
            alert(explanation);
        }

        function endPractice() {
            if (confirm('Are you sure you want to end the practice session? Your progress will be saved.')) {
                finishPractice();
            }
        }

        function finishPractice() {
            // Calculate score
            let correct = 0;
            const wrongAnswers = [];
            
            practiceState.questions.forEach((question, index) => {
                const userAnswer = practiceState.answers[index];
                if (userAnswer !== null && userAnswer === question.correct) {
                    correct++;
                } else if (userAnswer !== null) {
                    wrongAnswers.push({
                        question: question.question,
                        userAnswer: question.options[userAnswer],
                        correctAnswer: question.options[question.correct],
                        explanation: question.explanation,
                        tips: question.tips || []
                    });
                }
            });
            
            practiceState.score = correct;
            practiceState.wrongAnswers = wrongAnswers;
            
            // Calculate time taken
            const endTime = new Date();
            const timeTaken = Math.floor((endTime - practiceState.startTime) / 1000);
            const minutes = Math.floor(timeTaken / 60);
            const seconds = timeTaken % 60;
            
            // Update results modal
            const score = Math.round((correct / practiceState.questions.length) * 100);
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('scoreText').textContent = correct;
            document.getElementById('totalText').textContent = practiceState.questions.length;
            document.getElementById('timeTakenText').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('accuracyText').textContent = `${score}%`;
            
            // Update user progress
            updateUserProgress(practiceState.subject.id, correct, practiceState.questions.length);
            
            // Show results modal
            practiceInterface.style.display = 'none';
            resultsModal.style.display = 'flex';
        }

        function updateUserProgress(subjectId, correct, total) {
            // In a real app, this would save to a database
            // For now, we'll update local storage
            const progress = JSON.parse(localStorage.getItem('practiceProgress') || '{}');
            
            if (!progress[subjectId]) {
                progress[subjectId] = {
                    totalAttempted: 0,
                    totalCorrect: 0,
                    lastScore: 0
                };
            }
            
            progress[subjectId].totalAttempted += total;
            progress[subjectId].totalCorrect += correct;
            progress[subjectId].lastScore = Math.round((correct / total) * 100);
            
            localStorage.setItem('practiceProgress', JSON.stringify(progress));
            
            // Update the UI
            const subject = subjects.find(s => s.id === subjectId);
            if (subject) {
                subject.completed = Math.min(subject.completed + total, subject.questions);
                subject.accuracy = Math.round(
                    ((subject.accuracy * subject.completed) + (score * total)) / 
                    (subject.completed + total)
                );
                renderSubjects();
            }
        }

        function loadUserProgress() {
            const progress = JSON.parse(localStorage.getItem('practiceProgress') || '{}');
            
            subjects.forEach(subject => {
                if (progress[subject.id]) {
                    subject.completed = Math.min(progress[subject.id].totalAttempted, subject.questions);
                    subject.accuracy = progress[subject.id].lastScore;
                }
            });
            
            renderSubjects();
        }

        function closeResultsModal() {
            resultsModal.style.display = 'none';
        }

        function reviewWrongAnswers() {
            if (!practiceState.wrongAnswers || practiceState.wrongAnswers.length === 0) {
                alert('No wrong answers to review!');
                return;
            }
            
            practiceState.isReviewing = true;
            practiceState.currentQuestion = 0;
            
            // Create review questions
            practiceState.reviewQuestions = practiceState.wrongAnswers.map((wrong, index) => ({
                ...practiceState.questions.find(q => q.question === wrong.question),
                userAnswer: practiceState.answers[practiceState.questions.findIndex(q => q.question === wrong.question)]
            }));
            
            // Show practice interface in review mode
            practiceInterface.style.display = 'flex';
            resultsModal.style.display = 'none';
            
            // Update for review mode
            document.querySelector('.test-header h2').innerHTML = 
                '<i class="fas fa-clipboard-check"></i> Review Mode';
            
            updatePracticeQuestion();
        }

        function practiceMore() {
            resultsModal.style.display = 'none';
            openPracticeModal(practiceState.subject);
        }

        function closeModal(modal) {
            modal.style.display = 'none';
        }

        // Weekly Test Functions
        function startWeeklyTest() {
            // Generate random questions from all subjects
            weeklyTestState.questions = generateWeeklyTestQuestions();
            weeklyTestState.currentQuestion = 0;
            weeklyTestState.answers = new Array(weeklyTestState.questions.length).fill(null);
            weeklyTestState.score = 0;
            weeklyTestState.startTime = new Date();
            weeklyTestState.timeRemaining = 90 * 60;
            
            // In a real app, you would navigate to a test page
            // For this demo, we'll simulate starting the test
            alert(`Starting Weekly Test with ${weeklyTestState.questions.length} random questions.\n\nDuration: 90 minutes\nSubjects: All\n\nGood luck!`);
            
            // You would then redirect to the test interface
            // window.location.href = 'weekly-test.html';
        }

        function generateWeeklyTestQuestions() {
            let allQuestions = [];
            
            // Take questions from all subjects
            subjects.forEach(subject => {
                if (questionsDatabase[subject.id]) {
                    // Take 5-10 questions from each subject
                    const count = Math.floor(Math.random() * 6) + 5;
                    const subjectQuestions = questionsDatabase[subject.id];
                    
                    // Shuffle and take required number
                    const shuffled = [...subjectQuestions].sort(() => Math.random() - 0.5);
                    allQuestions.push(...shuffled.slice(0, Math.min(count, subjectQuestions.length)));
                }
            });
            
            // Shuffle all questions and take 50
            allQuestions = allQuestions.sort(() => Math.random() - 0.5);
            return allQuestions.slice(0, 50);
        }

        // Question Generation Functions (Sample questions for demo)
        function generateJavaScriptQuestions() {
            return [
                {
                    question: "What is the output of: console.log(typeof null)?",
                    options: ["object", "null", "undefined", "string"],
                    correct: 0,
                    explanation: "In JavaScript, typeof null returns 'object' which is a historical bug.",
                    difficulty: "easy",
                    tips: ["Remember that typeof null is 'object'", "This is a well-known JavaScript quirk"]
                },
                {
                    question: "What does the 'this' keyword refer to in an arrow function?",
                    options: ["The global object", "The object that defined the arrow function", "The object that called the function", "undefined"],
                    correct: 1,
                    explanation: "Arrow functions don't have their own 'this' binding. They inherit 'this' from the parent scope.",
                    difficulty: "medium",
                    tips: ["Arrow functions inherit 'this' from surrounding scope", "Regular functions have their own 'this'"]
                },
                {
                    question: "What is a closure in JavaScript?",
                    options: [
                        "A function that returns another function",
                        "A function with access to variables from its outer scope even after the outer function has returned",
                        "A way to close a browser window",
                        "A method to prevent memory leaks"
                    ],
                    correct: 1,
                    explanation: "A closure gives you access to an outer function's scope from an inner function.",
                    difficulty: "medium",
                    tips: ["Closures remember their lexical scope", "Useful for data privacy and function factories"]
                },
                {
                    question: "What is the difference between == and === in JavaScript?",
                    options: [
                        "== compares values, === compares values and types",
                        "=== is faster than ==",
                        "== converts types before comparison, === doesn't",
                        "Both A and C"
                    ],
                    correct: 3,
                    explanation: "== performs type coercion before comparison, while === checks both value and type without coercion.",
                    difficulty: "easy",
                    tips: ["Always use === for strict equality checking", "== can lead to unexpected results due to type coercion"]
                },
                {
                    question: "What is event bubbling in JavaScript?",
                    options: [
                        "When events are created dynamically",
                        "When an event starts from the target element and bubbles up to the root",
                        "When multiple events are triggered simultaneously",
                        "When events are prevented from propagating"
                    ],
                    correct: 1,
                    explanation: "Event bubbling is when an event starts at the most specific element and then flows upward toward the least specific element.",
                    difficulty: "medium",
                    tips: ["Use event.stopPropagation() to stop bubbling", "Event capturing is the opposite of bubbling"]
                }
            ];
        }

        function generatePythonQuestions() {
            return [
                {
                    question: "What is the difference between a list and a tuple in Python?",
                    options: [
                        "Lists are mutable, tuples are immutable",
                        "Tuples are faster than lists",
                        "Lists use square brackets, tuples use parentheses",
                        "All of the above"
                    ],
                    correct: 3,
                    explanation: "Lists are mutable, use [], and are generally slower. Tuples are immutable, use (), and are faster.",
                    difficulty: "easy",
                    tips: ["Use tuples for fixed data", "Use lists for dynamic data"]
                },
                {
                    question: "What is a Python generator?",
                    options: [
                        "A function that generates random numbers",
                        "A special function that yields values one at a time",
                        "A tool for generating documentation",
                        "A type of class constructor"
                    ],
                    correct: 1,
                    explanation: "Generators are functions that use yield to return values one at a time, preserving state between calls.",
                    difficulty: "medium",
                    tips: ["Generators are memory efficient", "Use yield instead of return"]
                }
            ];
        }

        function generateHTMLQuestions() {
            return [
                {
                    question: "What does the <section> element represent in HTML5?",
                    options: [
                        "A generic section of a document",
                        "A section of navigation links",
                        "The main content area",
                        "A footer section"
                    ],
                    correct: 0,
                    explanation: "<section> represents a standalone section of content, typically with a heading.",
                    difficulty: "easy",
                    tips: ["Use semantic HTML elements", "<section> should have a heading"]
                }
            ];
        }

        function generateCSSQuestions() {
            return [
                {
                    question: "What is the CSS box model?",
                    options: [
                        "The model for creating boxes",
                        "Content, padding, border, and margin",
                        "A way to position elements",
                        "A CSS framework"
                    ],
                    correct: 1,
                    explanation: "The CSS box model describes the rectangular boxes generated for elements including content, padding, border, and margin.",
                    difficulty: "easy",
                    tips: ["box-sizing: border-box includes padding and border in width", "Understand margin collapsing"]
                }
            ];
        }

        function generateReactQuestions() {
            return [
                {
                    question: "What are React hooks?",
                    options: [
                        "Functions that let you use state and other React features in functional components",
                        "Tools for debugging React applications",
                        "Methods for hooking into lifecycle events",
                        "CSS hooks for styling components"
                    ],
                    correct: 0,
                    explanation: "Hooks are functions that let you use React state and lifecycle features from function components.",
                    difficulty: "easy",
                    tips: ["Only call hooks at the top level", "Don't call hooks inside loops or conditions"]
                }
            ];
        }

        function generateCQuestions() {
            return [
                {
                    question: "What is a pointer in C?",
                    options: [
                        "A variable that stores the memory address of another variable",
                        "A tool for pointing to errors",
                        "A type of array",
                        "A function parameter"
                    ],
                    correct: 0,
                    explanation: "A pointer is a variable that stores the memory address of another variable.",
                    difficulty: "easy",
                    tips: ["Pointers enable dynamic memory allocation", "Be careful with pointer arithmetic"]
                }
            ];
        }

        function generateAlgorithmQuestions() {
            return [
                {
                    question: "What is the time complexity of bubble sort?",
                    options: ["O(n)", "O(n log n)", "O(n)", "O(log n)"],
                    correct: 2,
                    explanation: "Bubble sort has O(n) time complexity in worst and average cases.",
                    difficulty: "easy",
                    tips: ["Bubble sort is inefficient for large datasets", "Consider quicksort or mergesort instead"]
                }
            ];
        }

        function generateDataStructureQuestions() {
            return [
                {
                    question: "What is a binary search tree?",
                    options: [
                        "A tree where each node has at most two children",
                        "A sorted tree where left child < parent < right child",
                        "A tree used for binary searching",
                        "Both A and B"
                    ],
                    correct: 3,
                    explanation: "A BST is a binary tree where the left subtree contains only nodes with values less than the parent, and right subtree contains greater values.",
                    difficulty: "medium",
                    tips: ["BST enables efficient searching O(log n)", "Balanced trees prevent worst-case O(n)"]
                }
            ];
        }

        // Add more questions as needed...
        // For a complete implementation, you would add 50+ questions per subject
    </script>
</body>

</html>